{% extends 'base.html' %}

{% block title %}Test AI Assistant - HomaBay Souq{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="listing-form-wrapper">
        <div class="form-header">
            <h1 class="form-title">
                <i class="bi bi-robot"></i>
                Test AI Assistant
            </h1>
            <p class="form-subtitle">Quickly test AI listing generation using a short title and optional price.</p>
        </div>

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        {% endif %}

        {% if ai_error %}
        <div class="alert alert-danger">
            <i class="bi bi-exclamation-triangle"></i>
            <strong>AI Unavailable:</strong>
            <div>{{ ai_error }}</div>
            <div class="mt-1 small text-muted">The AI has been temporarily disabled; try again later.</div>
        </div>
        {% endif %}

        <div class="form-section">
            <form method="post" action="{% url 'ai_quick_listing' %}">
                {% csrf_token %}
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label required-field" for="title">Product Title</label>
                        <input type="text" class="form-control" id="title" name="title" placeholder="e.g., Brand New iPhone 17 Pro Max" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="price">Price (KES)</label>
                        <input type="number" class="form-control" id="price" name="price" placeholder="Optional">
                    </div>
                </div>
                <div class="form-actions mt-3">
                    <button type="submit" class="upload-btn w-100"><i class="bi bi-magic"></i> Generate with AI</button>
                </div>
            </form>
        </div>

        <div class="form-section mt-4">
            <h6><i class="bi bi-lightbulb"></i> Example Tests</h6>
            <ul>
                <li>Brand New iPhone 17 Pro Max</li>
                <li>Samsung Galaxy S25 Ultra</li>
                <li>Leather Jacket Size M</li>
                <li>Toyota RAV4 2020</li>
                <li>Wooden Dining Table</li>
            </ul>
        </div>

        {% if ai_enabled %}
            <div class="alert alert-success mt-3"><i class="bi bi-check-circle"></i> AI Assistant is ENABLED</div>
        {% else %}
            <div class="alert alert-warning mt-3"><i class="bi bi-exclamation-triangle"></i> AI Assistant is DISABLED
                <p class="mb-0 mt-2">Add your OpenAI API key to .env file to enable AI features.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
