{% extends 'base.html' %}
{% load static %}

{% block title %}Reset Password - Baysoko{% endblock %}

{% block extra_css %}
<style>
    /* ===== PASSWORD RESET PAGE - MATCHING LISTING_DETAIL ===== */
    .container-custom {
        padding-left: 8px;
        padding-right: 8px;
    }

    /* Breadcrumb */
    .breadcrumb {
        background: var(--bg-secondary);
        padding: 10px 12px;
        border-radius: var(--radius-md);
        margin-bottom: 16px;
        border: 1px solid var(--border-color);
        overflow-x: auto;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
        font-size: 12px;
    }

    .breadcrumb-item a {
        text-decoration: none;
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 11px;
    }

    /* Reset Card - Matching listing_detail hero card */
    .reset-card {
        background: var(--card-bg);
        border-radius: var(--radius-lg);
        overflow: hidden;
        box-shadow: var(--shadow-lg);
        margin-bottom: 20px;
        border: 1px solid var(--border-color);
        position: relative;
        max-width: 480px;
        margin: 0 auto;
    }

    .reset-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary), var(--accent));
    }

    /* Header - Similar to listing_detail hero */
    .reset-header {
        padding: 32px 24px;
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border-color);
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .reset-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            radial-gradient(circle at 20% 30%, rgba(6, 214, 160, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 70%, rgba(255, 107, 53, 0.1) 0%, transparent 50%);
    }

    .reset-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 20px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 2.2rem;
        position: relative;
        z-index: 2;
        box-shadow: 0 8px 32px rgba(var(--primary-rgb), 0.3);
        animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
    }

    .reset-title {
        font-size: 1.8rem;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 8px;
        position: relative;
        z-index: 2;
        background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .reset-subtitle {
        color: var(--text-secondary);
        font-size: 1rem;
        line-height: 1.5;
        max-width: 400px;
        margin: 0 auto;
        position: relative;
        z-index: 2;
    }

    /* Body */
    .reset-body {
        padding: 32px 24px;
    }

    /* Info Card - Matching listing_detail info cards */
    .info-card-reset {
        background: linear-gradient(135deg, rgba(var(--info-rgb), 0.05) 0%, rgba(var(--info-rgb), 0.02) 100%);
        border: 1px solid rgba(var(--info-rgb), 0.2);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 24px;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .info-card-reset:hover {
        border-color: rgba(var(--info-rgb), 0.4);
        transform: translateY(-2px);
        box-shadow: var(--shadow-sm);
    }

    .info-card-reset::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: linear-gradient(to bottom, var(--info), rgba(var(--info-rgb), 0.5));
        border-radius: 2px 0 0 2px;
    }

    .info-card-title {
        font-size: 1rem;
        font-weight: 700;
        color: var(--info);
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .info-card-text {
        color: var(--text-secondary);
        font-size: 0.9rem;
        line-height: 1.5;
        margin: 0;
    }

    /* Form - Matching listing_detail form styling */
    .reset-form-group {
        margin-bottom: 24px;
    }

    .reset-form-label {
        display: block;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 8px;
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .reset-input-group {
        position: relative;
        display: flex;
        align-items: center;
    }

    .reset-input {
        width: 100%;
        padding: 16px 20px;
        background: var(--input-bg);
        border: 1px solid var(--border-color);
        border-radius: 10px;
        font-size: 1rem;
        color: var(--text-primary);
        transition: all 0.3s ease;
        outline: none;
    }

    .reset-input:focus {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);
        transform: translateY(-2px);
    }

    .reset-input-icon {
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-tertiary);
        font-size: 1.2rem;
        pointer-events: none;
    }

    .reset-input-with-icon {
        padding-left: 52px;
    }

    /* Submit Button - Matching listing_detail action buttons */
    .reset-submit-btn {
        width: 100%;
        padding: 18px 24px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        position: relative;
        overflow: hidden;
        margin-top: 8px;
        box-shadow: var(--shadow-sm);
    }

    .reset-submit-btn:hover:not(:disabled) {
        background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary) 100%);
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
    }

    .reset-submit-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }

    /* Messages - Similar to listing_detail alerts */
    .reset-messages {
        margin-bottom: 24px;
    }

    .reset-alert {
        padding: 16px;
        border-radius: 10px;
        margin-bottom: 16px;
        display: flex;
        align-items: flex-start;
        gap: 12px;
        animation: slideInDown 0.5s ease-out;
        position: relative;
    }

    .reset-alert::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        border-radius: 2px 0 0 2px;
    }

    .reset-alert-success {
        background: linear-gradient(135deg, rgba(var(--success-rgb), 0.1) 0%, rgba(var(--success-rgb), 0.05) 100%);
        border: 1px solid rgba(var(--success-rgb), 0.2);
    }
    
    .reset-alert-success::before {
        background: linear-gradient(to bottom, var(--success), rgba(var(--success-rgb), 0.5));
    }

    .reset-alert-danger {
        background: linear-gradient(135deg, rgba(var(--danger-rgb), 0.1) 0%, rgba(var(--danger-rgb), 0.05) 100%);
        border: 1px solid rgba(var(--danger-rgb), 0.2);
    }
    
    .reset-alert-danger::before {
        background: linear-gradient(to bottom, var(--danger), rgba(var(--danger-rgb), 0.5));
    }

    .reset-alert-info {
        background: linear-gradient(135deg, rgba(var(--info-rgb), 0.1) 0%, rgba(var(--info-rgb), 0.05) 100%);
        border: 1px solid rgba(var(--info-rgb), 0.2);
    }
    
    .reset-alert-info::before {
        background: linear-gradient(to bottom, var(--info), rgba(var(--info-rgb), 0.5));
    }

    .reset-alert-icon {
        font-size: 1.2rem;
        flex-shrink: 0;
        margin-top: 2px;
    }

    .reset-alert-content {
        flex: 1;
        font-size: 0.95rem;
        color: var(--text-primary);
    }

    /* Footer */
    .reset-footer {
        padding: 24px;
        background: var(--bg-secondary);
        border-top: 1px solid var(--border-color);
        text-align: center;
    }

    .reset-footer-text {
        color: var(--text-secondary);
        font-size: 0.95rem;
    }

    .reset-footer-link {
        color: var(--primary);
        text-decoration: none;
        font-weight: 700;
        transition: all 0.2s ease;
    }

    .reset-footer-link:hover {
        color: var(--primary-dark);
        text-decoration: underline;
    }

    /* Animations */
    @keyframes slideInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Responsive */
    @media (max-width: 768px) {
        .reset-header {
            padding: 24px 20px;
        }

        .reset-icon {
            width: 70px;
            height: 70px;
            font-size: 2rem;
        }

        .reset-title {
            font-size: 1.5rem;
        }

        .reset-subtitle {
            font-size: 0.95rem;
        }

        .reset-body {
            padding: 24px 20px;
        }

        .info-card-reset {
            padding: 16px;
        }
    }

    @media (max-width: 576px) {
        .reset-card {
            border-radius: 12px;
        }

        .reset-header {
            padding: 20px 16px;
        }

        .reset-icon {
            width: 60px;
            height: 60px;
            font-size: 1.8rem;
        }

        .reset-title {
            font-size: 1.3rem;
        }

        .reset-body {
            padding: 20px 16px;
        }

        .reset-input {
            padding: 14px 16px;
            font-size: 0.95rem;
        }

        .reset-submit-btn {
            padding: 16px 20px;
            font-size: 1rem;
        }

        .reset-footer {
            padding: 20px 16px;
        }
    }

    @media (max-width: 375px) {
        .reset-header {
            padding: 16px;
        }

        .reset-icon {
            width: 50px;
            height: 50px;
            font-size: 1.6rem;
        }

        .reset-title {
            font-size: 1.2rem;
        }

        .reset-body {
            padding: 16px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-custom py-4">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'home' %}"><i class="bi bi-house"></i> Home</a></li>
            <li class="breadcrumb-item"><a href="{% url 'login' %}"><i class="bi bi-box-arrow-in-right"></i> Login</a></li>
            <li class="breadcrumb-item active" aria-current="page">Reset Password</li>
        </ol>
    </nav>

    <!-- Reset Card -->
    <div class="reset-card">
        <!-- Header -->
        <div class="reset-header">
            <div class="reset-icon">
                <i class="bi bi-key"></i>
            </div>
            <h1 class="reset-title">Reset Password</h1>
            <p class="reset-subtitle">
                Enter your email address below and we'll send you instructions to reset your password.
            </p>
        </div>

        <!-- Body -->
        <div class="reset-body">
            <!-- Messages -->
            {% if messages %}
            <div class="reset-messages">
                {% for message in messages %}
                <div class="reset-alert reset-alert-{{ message.tags }}">
                    <i class="bi {% if message.tags == 'success' %}bi-check-circle{% else %}bi-exclamation-circle{% endif %} reset-alert-icon"></i>
                    <div class="reset-alert-content">{{ message }}</div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Info Card -->
            <div class="info-card-reset">
                <div class="info-card-title">
                    <i class="bi bi-info-circle"></i>
                    Password Reset Instructions
                </div>
                <p class="info-card-text">
                    Enter the email address associated with your Baysoko account, and we'll send you a secure link to reset your password within minutes.
                </p>
            </div>

            <!-- Form -->
            <form method="post" novalidate id="resetForm">
                {% csrf_token %}
                
                <!-- Email Field -->
                <div class="reset-form-group">
                    <label class="reset-form-label" for="id_email">
                        <i class="bi bi-envelope"></i>
                        Email Address <span class="text-danger">*</span>
                    </label>
                    <div class="reset-input-group">
                        <i class="bi bi-envelope reset-input-icon"></i>
                        <input type="email" 
                               name="email" 
                               class="reset-input reset-input-with-icon {% if form.email.errors %}is-invalid{% endif %}" 
                               id="id_email" 
                               placeholder="your.email@example.com"
                               value="{{ form.email.value|default:'' }}"
                               required
                               autofocus>
                    </div>
                    {% if form.email.errors %}
                        <div class="reset-alert reset-alert-danger mt-3">
                            <i class="bi bi-exclamation-circle reset-alert-icon"></i>
                            <div class="reset-alert-content">
                                {% for error in form.email.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                </div>

                <!-- Submit Button -->
                <button type="submit" class="reset-submit-btn" id="submitBtn">
                    <i class="bi bi-send"></i>
                    Send Reset Link
                </button>
            </form>
        </div>

        <!-- Footer -->
        <div class="reset-footer">
            <p class="reset-footer-text">
                Remember your password? 
                <a href="{% url 'login' %}" class="reset-footer-link">Back to Login</a>
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('resetForm');
    const submitBtn = document.getElementById('submitBtn');
    
    if (form && submitBtn) {
        form.addEventListener('submit', function() {
            const originalText = submitBtn.innerHTML;
            
            // Show loading state
            submitBtn.innerHTML = '<i class="bi bi-arrow-repeat spin me-2"></i> Sending...';
            submitBtn.disabled = true;
            
            // Re-enable after 5 seconds (in case of error)
            setTimeout(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }, 5000);
        });
    }
    
    // Add spin animation
    const style = document.createElement('style');
    style.textContent = `
        .spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    `;
    document.head.appendChild(style);
    
    // Focus email input on load
    const emailInput = document.getElementById('id_email');
    if (emailInput) {
        setTimeout(() => {
            emailInput.focus();
        }, 300);
    }
});
</script>
{% endblock %}